option_settings:
  aws:elasticbeanstalk:environment:
    LoadBalancerType: application
    ServiceRole: aws-elasticbeanstalk-service-role
  
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
    HealthCheckSuccessThreshold: Ok
    HealthCheckURL: /health
    HealthCheckInterval: 15
    HealthyThresholdCount: 2
    UnhealthyThresholdCount: 5
  
  aws:autoscaling:asg:
    MinSize: 2
    MaxSize: 10
    Cooldown: 300
  
  aws:autoscaling:trigger:
    MeasureName: CPUUtilization
    Unit: Percent
    LowerThreshold: 20
    UpperThreshold: 70
    ScaleUpIncrement: 1
    ScaleDownIncrement: -1
    
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /health
    HealthCheckInterval: 15
    HealthyThresholdCount: 2
    UnhealthyThresholdCount: 5
    HealthCheckTimeout: 5
    StickinessEnabled: false
    StickinessLBCookieDuration: 86400
    
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /health
    
  aws:ec2:instances:
    InstanceTypes: t3.small,t3.medium
    EnableSpot: false
    SupportedArchitectures: x86_64
    
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 30
    
  aws:elasticbeanstalk:cloudwatch:logs:health:
    HealthStreamingEnabled: true
    DeleteOnTerminate: false
    RetentionInDays: 7

Resources:
  AWSEBAutoScalingGroup:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      HealthCheckType: ELB
      HealthCheckGracePeriod: 300
      VPCZoneIdentifier:
        Fn::GetAZs: ""
